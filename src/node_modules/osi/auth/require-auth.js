import React, { Component } from 'react'
import PropTypes from 'prop-types'
import { connect } from 'react-redux'
import { Link, browserHistory } from 'react-router'


export default (ComposedComponent) => {
  class Authenticate extends Component {
    render () {
      const { isAuthenticated } = this.props
      return (
        <ComposedComponent {...this.props} />
      )
    }

    componentWillMount () {
      if (!this.props.isAuthenticated) {
        // this.props.addFlashMessage({
        console.log(`Error!`, {
          type: 'error',
          text: 'You need to login to access this page.'
        })
        browserHistory.push('/login')
      }
    }
  }

  Authenticate.propTypes = {
    isAuthenticated: PropTypes.bool.isRequired
  }
  const mapStateToProps = state => ({
    isAuthenticated: !!state.user.loggedIn
  })

  return connect(mapStateToProps)(Authenticate)
}
